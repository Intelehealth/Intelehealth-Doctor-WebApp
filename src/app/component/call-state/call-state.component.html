<div class="position-relative h-100">
  <div
    #mainContainer
    class="call-state h-100 position-relative"
    [ngClass]="collapsed_message ? 'call-state-collapsed' : ''"
  >
    <div class="d-flex">
      <video #remoteVideo class="remoteVideo mx-auto" autoplay></video>
    </div>
    <div
      #localContainer
      class="call-person"
      [ngClass]="{ 'd-none': isVideoOff }"
    >
      <video
        #localVideo
        autoplay
        class="localVideo"
        [ngClass]="{ 'collapse-localVideo': collapsed_message }"
      ></video>
    </div>
    <div class="call-person" [ngClass]="{ 'd-none': !isVideoOff }">
      <img class="voice" [src]="voiceCallIcons | async" *ngIf="!isMute" />
      <img
        class="voice mute-mic"
        src="assets/svgs/mute-mic.svg"
        *ngIf="isMute"
      />
      <img class="dots" src="assets/svgs/dots_group.svg" />
      <img class="frame" src="assets/svgs/dr.frame.svg" />
    </div>
    <div class="call-voice">
      <img [src]="voiceCallIcons | async" class="voice-call-icons" />
    </div>
    <div class="call-time text">
      Call ends in
      <div class="time text">12:32</div>
    </div>
    <div class="back-cover" *ngIf="!isRemote">
      <img src="assets/svgs/Group.svg" />
    </div>
    <div class="call-features">
      <button class="logo call-icon" (click)="endCallInRoom()">
        <img src="assets/svgs/phone_red.svg" />
      </button>
      <button class="logo mic-icon" (click)="toggleMute()" *ngIf="!isMute">
        <img src="assets/svgs/microphone.svg" />
      </button>

      <button class="no-mic-icon" (click)="toggleMute()" *ngIf="isMute">
        <img src="assets/svgs/mute.svg" />
      </button>

      <button
        class="logo video-icon"
        (click)="toggleVideo()"
        *ngIf="!isVideoOff"
      >
        <img src="assets/svgs/video-call.svg" />
      </button>

      <button class="no-video-icon" (click)="toggleVideo()" *ngIf="isVideoOff">
        <img src="assets/svgs/no-video.svg" />
      </button>

      <button class="logo message-icon" (click)="toggleCollapseMessage()">
        <img src="assets/svgs/message.svg" />
      </button>
    </div>
    <div class="zomm">
      <button
        class="logo zoom-icon"
        (click)="toggleZoomIn()"
        *ngIf="!isFullscreen"
      >
        <img src="assets/svgs/minimize.svg" />
      </button>

      <button class="logo" (click)="toggleZoomOut()" *ngIf="isFullscreen">
        <img width="30px" height="30px" src="assets/svgs/maximize.svg" />
      </button>
    </div>
  </div>

  <div class="message-container" *ngIf="collapsed_message">
    <div class="profile-section">
      <div class="picture">
        <img src="assets/icons/message/Frame2608562.png" />
      </div>
      <div class="name">{{ patientName }}</div>
    </div>
    <div #chatBody class="body">
      <div class="chat-time"></div>
      <div class="message">
        <div
          class="conversation"
          [ngClass]="{ me: msg?.fromUser === chatSvc?.user?.uuid }"
          *ngFor="let msg of messages"
        >
          <div class="messageContent">
            {{ msg.message }}
          </div>

          <div class="read-unread-messages mt-2">
            <div class="msg-time">
              {{ msg.createdAt | amDateFormat : "LT" }}
            </div>
            <ng-container *ngIf="msg?.fromUser === chatSvc?.user?.uuid">
              <div class="read-unread-img">
                <img
                  height="16px"
                  width="16px"
                  [src]="
                    msg.isRead
                      ? 'assets/svgs/read.svg'
                      : 'assets/svgs/sent-msg.svg'
                  "
                />
              </div>
              <span class="read-unread-label">
                {{ msg.isRead ? "Read" : "Sent" }}
              </span>
            </ng-container>
          </div>
        </div>
      </div>
    </div>
    <div class="footer">
      <div class="textarea position-relative">
        <input
          type="text"
          [(ngModel)]="message"
          (keyup.enter)="sendMessage($event)"
          placeholder="Enter your message"
        />
        <img
          class="attach-img click"
          height="20px"
          width="20px"
          src="assets/svgs/attach.svg"
          (click)="inputField.click()"
        />
        <input #inputField hidden type="file" />
      </div>
      <div class="sent-box" (click)="sendMessages()">
        <img src="assets/svgs/sent.svg" />
      </div>
    </div>
  </div>
</div>
